<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>è¦‹ãŸã„ã‚¢ãƒ‹ãƒ¡ToDoãƒªã‚¹ãƒˆ</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP&display=swap" rel="stylesheet">
  <style>
    /* ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå¤‰æ•° */
:root {
  --bg-gradient: linear-gradient(to right, #141e30, #243b55);
  --text-color: #fff;
  --li-bg: rgba(255,255,255,0.05);
  --li-border: rgba(255,255,255,0.1);
  --btn-bg: linear-gradient(135deg, #cb1111, #fc8225);
  --btn-hover-bg: linear-gradient(135deg, #e0615e, #e0cd00);
  /* â€¦ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒœã‚¿ãƒ³ã€ã‚µã‚¤ãƒˆãƒœã‚¿ãƒ³ã€è©±æ•°ãƒœã‚¿ãƒ³ã®å¤‰æ•°ã‚‚åŒæ§˜ã«å®šç¾©â€¦ */
}

/* ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰ç”¨ã«ä¸Šæ›¸ãã™ã‚‹å¤‰æ•° */
.light-mode {
  --bg-gradient: linear-gradient(to right, #fafafa, #f0f0f0);
  --text-color: #333;
  --li-bg: #fff;
  --li-border: rgba(0,0,0,0.1);
  --btn-bg: linear-gradient(135deg, #ff8a65, #ffd54f);
  --btn-hover-bg: linear-gradient(135deg, #ffa07a, #ffe082);
  /* â€¦ä»–ã®ãƒœã‚¿ãƒ³å¤‰æ•°ã‚‚åŒæ§˜ã«å®šç¾©â€¦ */
   /* å…¥åŠ›æ¬„ï¼ã‚»ãƒ¬ã‚¯ãƒˆã®è‰² */
  --input-bg: #e0e0e0;      /* ä¾‹ï¼šè–„ã„ã‚°ãƒ¬ãƒ¼ */
  --input-text: #333;       /* ä¾‹ï¼šæ¿ƒã„æ–‡å­—è‰² */

  /* è¦–è´å®Œäº†ãƒœã‚¿ãƒ³ï¼ˆã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒœã‚¿ãƒ³ï¼‰ã®è‰² */
  --status-btn-bg: linear-gradient(135deg, #4caf50, #357a38);
  --status-btn-hover-bg: linear-gradient(135deg, #66bb6a, #4caf50);
}
    
  body {
  font-family: 'Noto Sans JP', sans-serif;
  background: var(--bg-gradient);
  color: var(--text-color);
  transition: background 0.3s, color 0.3s;
  text-align: center;
  padding: 20px;
}

h1 {
  font-size: 32px;
  margin-bottom: 20px;
}

#animeList {
  margin-top: 20px;
  padding: 0;
  list-style: none;
  max-width: 900px;
  margin: auto;
}

li {
  background: var(--li-bg);
  border: 1px solid var(--li-border);
  transition: background 0.3s, border 0.3s;
  backdrop-filter: blur(4px);
  color: #fff;
  margin: 20px auto;
  padding: 20px;
  border-radius: 12px;
  box-shadow: 0 4px 20px rgba(0,0,0,0.4);
  display: flex;
  flex-direction: column;
  gap: 15px;
}

li:hover {
  transform: translateY(-5px);
}

.anime-details {
  font-size: 24px;
  text-align: left;
  font-weight: bold;
  border: 1px solid rgba(255,255,255,0.3);
  padding: 6px 10px;
  border-radius: 6px;
  background-color: rgba(255,255,255,0.1);
}

.anime-meta {
  font-size: 14px;
  padding-top: 2px;
  padding-left: 2px;
  text-align: left;
  color: #9c9c9c;
}

.button-group {
  display: flex;
  flex-direction: row;
  gap: 10px;
  justify-content: flex-end;
  flex-wrap: wrap;
}

/* å…±é€šã®ãƒœã‚¿ãƒ³ãƒ‡ã‚¶ã‚¤ãƒ³ */
button {
  background: var(--btn-bg);
  transition: background 0.3s, transform 0.2s;
  border: none;
  color: white;
  border-radius: 8px;
  cursor: pointer;
  padding: 8px 12px;
  transition: background 0.3s ease, transform 0.2s ease;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* å°ã•ã‚ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°: è©±æ•°æ›´æ–°ãƒ»ã‚µã‚¤ãƒˆåˆ‡æ›¿å°‚ç”¨ */
.inline-btn {
  padding: 4px 6px;
}


button:hover {
  background: var(--btn-hover-bg);
  transform: scale(1.05);
}

.status-btn {
  background: var(--status-btn-bg);
}
.status-btn:hover {
  background: var(--status-btn-hover-bg);
}
.site-btn {
  background: var(--site-btn-bg);
}
.site-btn:hover {
  background: var(--site-btn-hover-bg);
}
.episode-btn {
  background: var(--episode-btn-bg);
}
.episode-btn:hover {
  background: var(--episode-btn-hover-bg);
}

a.site-link {
  color: #f1c40f;
  text-decoration: none;
}
a.site-link:hover {
  text-decoration: underline;
}

input, select {
  padding: 10px;
  border-radius: 6px;
  border: none;
  margin: 5px 0;
  width: 100%;
  box-sizing: border-box;
  background: var(--input-bg);
  color: var(--input-text);
}

#showInputButton {
  background: #e74c3c;
  border: none;
  color: white;
  padding: 5px 20px;
  border-radius: 8px;
  font-size: 12px;
  margin: 0 auto;
  cursor: pointer;
  transition: background 0.3s ease;
}

#showInputButton:hover {
  background: #c0392b;
}
.star {
  color: gold;
  font-size: 20px;
}

.watched {
  background: rgba(46, 204, 113, 0.2); /* æ˜ã‚‹ã„ã‚°ãƒªãƒ¼ãƒ³ç³» */
  border: 1px solid rgba(46, 204, 113, 0.4);
}

/* ãƒ€ãƒ¼ã‚¯ï¼ãƒ©ã‚¤ãƒˆå•ã‚ãšã€ã‚¿ã‚¤ãƒˆãƒ«å…¥åŠ›æ¬„ã®ã‚¹ã‚¿ã‚¤ãƒ« */
.title-input {
  width: 100%;
  font-size: 20px;
  padding: 4px;
  border-radius: 6px;
  border: none;
  background: var(--input-bg);
  color: var(--input-text);
  transition: background 0.3s, color 0.3s;
}


@media (min-width: 600px) {
  li {
    flex-direction: row;
    justify-content: space-between;
    align-items: center;
  }
  .anime-details { flex: 1; }
  .anime-meta { flex: 2; }
  .button-group {
    flex: 0 0 auto;
    margin-left: 20px;
  }
}


  </style>
</head>
<body>
  <button id="modeToggle">ğŸŒ™ï¼â˜€ï¸ ãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿</button>

  <h1>è¦‹ãŸã„ã‚¢ãƒ‹ãƒ¡ToDoãƒªã‚¹ãƒˆ</h1>

  <button id="showInputButton">æ–°ã—ã„ã‚¢ãƒ‹ãƒ¡ã‚’è¿½åŠ </button>

  <div id="inputArea" style="display:none; margin-top:20px; max-width:600px; margin:auto;">
    <input id="titleInput" placeholder="ã‚¢ãƒ‹ãƒ¡ã‚¿ã‚¤ãƒˆãƒ«" />
    <select id="weekdayInput">
      <option value="æœˆæ›œæ—¥">æœˆæ›œæ—¥</option>
      <option value="ç«æ›œæ—¥">ç«æ›œæ—¥</option>
      <option value="æ°´æ›œæ—¥">æ°´æ›œæ—¥</option>
      <option value="æœ¨æ›œæ—¥">æœ¨æ›œæ—¥</option>
      <option value="é‡‘æ›œæ—¥">é‡‘æ›œæ—¥</option>
      <option value="åœŸæ›œæ—¥">åœŸæ›œæ—¥</option>
      <option value="æ—¥æ›œæ—¥">æ—¥æ›œæ—¥</option>
      <option value="æ”¾é€æ¸ˆã¿">æ”¾é€æ¸ˆã¿</option>
    </select>
    <input id="episodesInput" type="number" min="1" placeholder="ç·è©±æ•°" />
    <input id="currentEpisodeInput" type="number" min="0" placeholder="ç¾åœ¨è¦–è´è©±æ•°" />
    <select id="genreInput">
      <option value="ã‚¢ã‚¯ã‚·ãƒ§ãƒ³">ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</option>
      <option value="æ‹æ„›">æ‹æ„›</option>
      <option value="æ—¥å¸¸">æ—¥å¸¸</option>
      <option value="SF">SF</option>
      <option value="ãƒ•ã‚¡ãƒ³ã‚¿ã‚¸ãƒ¼">ãƒ•ã‚¡ãƒ³ã‚¿ã‚¸ãƒ¼</option>
    </select>
    <select id="siteInput">
      <option value="Netflix">Netflix</option>
      <option value="Amazon Prime">Amazon Prime</option>
      <option value="Disney+">Disney+</option>
      <option value="dã‚¢ãƒ‹ãƒ¡ã‚¹ãƒˆã‚¢">dã‚¢ãƒ‹ãƒ¡ã‚¹ãƒˆã‚¢</option>
      <option value="Hulu">Hulu</option>
      <option value="U-NEXT">U-NEXT</option>
      <option value="Abema">Abema</option>
      <option value="9anime">9anime</option>
      <option value="ãã®ä»–">ãã®ä»–</option>
    </select>
    <button onclick="addAnime()">ã‚¢ãƒ‹ãƒ¡ã‚’è¿½åŠ </button>
    
  </div>

  <ul id="animeList"></ul>

  <script>
    let animes = [];

    const siteLinks = {
      "Netflix": "https://www.netflix.com/",
      "Amazon Prime": "https://www.amazon.co.jp/gp/video/storefront",
      "Disney+": "https://www.disneyplus.com/ja-jp",
      "dã‚¢ãƒ‹ãƒ¡ã‚¹ãƒˆã‚¢": "https://anime.dmkt-sp.jp/",
      "Hulu": "https://www.hulu.jp/",
      "U-NEXT": "https://video.unext.jp/",
      "Abema": "https://abema.tv/",
      "9anime": "https://9animetv.to/",
    };

    const siteSearchLinks = {
      "Netflix": "https://www.netflix.com/search?q=",
      "Amazon Prime": "https://www.amazon.co.jp/gp/video/search?phrase=",
      "Disney+": "https://www.disneyplus.com/ja-jp/search/",
      "dã‚¢ãƒ‹ãƒ¡ã‚¹ãƒˆã‚¢": "https://animestore.docomo.ne.jp/animestore/sch_pc?searchKey=",
      "Hulu": "https://www.hulu.jp/search?q=",
      "U-NEXT": "https://video.unext.jp/freeword?query=",
      "Abema": "https://abema.tv/search?q=",
      "9anime": "https://9animetv.to/search?keyword=",
      "ãã®ä»–": "#"
    };

    window.onload = function () {
      const saved = localStorage.getItem("animes");
      if (saved) {
        animes = JSON.parse(saved);
        renderAnimes();
      }
    };

    function addAnime() {
      const title = document.getElementById("titleInput").value.trim();
      const weekday = document.getElementById("weekdayInput").value;
      const episodes = document.getElementById("episodesInput").value.trim();
      const currentEpisode = document.getElementById("currentEpisodeInput").value.trim();
      const genre = document.getElementById("genreInput").value;
      const site = document.getElementById("siteInput").value;

      if (title) {
        animes.push({
          title: title,
          weekday: weekday,
          episodes: episodes,
          currentEpisode: currentEpisode,
          genre: genre,
          site: site,
          status: "æœªè¦–è´",
          rating: null
        });
        clearInputs();
        saveAnimes();
        renderAnimes();

        document.getElementById("inputArea").style.display = "none";
        showBtn.style.display = "inline-block";
      } else {
        alert("ã‚¿ã‚¤ãƒˆãƒ«ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼");
      }
    }

    function clearInputs() {
      document.getElementById("titleInput").value = "";
      document.getElementById("weekdayInput").value = "æœˆæ›œæ—¥";
      document.getElementById("episodesInput").value = "";
      document.getElementById("currentEpisodeInput").value = "";
      document.getElementById("genreInput").value = "ã‚¢ã‚¯ã‚·ãƒ§ãƒ³";
      document.getElementById("siteInput").value = "Netflix";
    }

    function deleteAnime(title) {
      animes = animes.filter(a => a.title !== title);
      saveAnimes();
      renderAnimes();
    }

    function toggleStatus(title) {
      const anime = animes.find(a => a.title === title);
      if (anime) {
        if (anime.status === "æœªè¦–è´") {
          const rating = prompt("è¦–è´æ¸ˆã¿ã«ã—ã¾ã™ã€‚è©•ä¾¡ã‚’1ã€œ5ã§å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆã‚­ãƒ£ãƒ³ã‚»ãƒ«ã§æœªè©•ä¾¡ï¼‰");
          if (rating) {
            const num = parseInt(rating);
            if (num >=1 && num <=5) {
              anime.rating = num;
            } else {
              alert("1ã€œ5ã®æ•°å€¤ã§å…¥åŠ›ã—ã¦ãã ã•ã„");
              return;
            }
          }
          anime.status = "è¦–è´æ¸ˆã¿";
        } else {
          anime.status = "æœªè¦–è´";
          anime.rating = null;
        }
        saveAnimes();
        renderAnimes();
      }
    }

    function toggleSite(title) {
      const anime = animes.find(a => a.title === title);
      if (anime) {
        const sites = Object.keys(siteLinks);
        let currentIndex = sites.indexOf(anime.site);
        currentIndex = (currentIndex + 1) % sites.length;
        anime.site = sites[currentIndex];
        saveAnimes();
        renderAnimes();
      }
    }

    function updateCurrentEpisode(title) {
      const anime = animes.find(a => a.title === title);
      if (anime) {
        const newEp = prompt("ç¾åœ¨è¦–è´ä¸­ã®è©±æ•°ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:", anime.currentEpisode || "");
        if (newEp !== null) {
          anime.currentEpisode = newEp;
          saveAnimes();
          renderAnimes();
        }
      }
    }

        function updateCurrentEpisodeDirect(title, newEp) {
      const anime = animes.find(a => a.title === title);
      if (anime) {
        anime.currentEpisode = newEp;
        saveAnimes();
      }
    }

    function updateTitle(oldTitle, newTitle) {
  if (!newTitle.trim()) {
    alert("ã‚¿ã‚¤ãƒˆãƒ«ã‚’ç©ºã«ã™ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚");
    return;
  }
  // åŒã˜ã‚¿ã‚¤ãƒˆãƒ«ãŒæ—¢ã«å­˜åœ¨ã™ã‚‹å ´åˆã€ä¸Šæ›¸ãã‚’é˜²ã
  if (animes.some(a => a.title === newTitle.trim() && a.title !== oldTitle)) {
    alert("åŒã˜ã‚¿ã‚¤ãƒˆãƒ«ã®ã‚¢ãƒ‹ãƒ¡ãŒæ—¢ã«ã‚ã‚Šã¾ã™ã€‚åˆ¥ã®åå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚");
    return;
  }

  const anime = animes.find(a => a.title === oldTitle);
  if (anime) {
    anime.title = newTitle.trim();
    saveAnimes();
    renderAnimes();
  }
}

function renderAnimes() {
  const list = document.getElementById("animeList");
  list.innerHTML = "";

  // ã‚½ãƒ¼ãƒˆ: æœªè¦–è´ãŒå…ˆã€åŒã˜ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãªã‚‰ã‚¿ã‚¤ãƒˆãƒ«æ˜‡é †
  const sorted = [...animes].sort((a, b) => {
    if (a.status === b.status) {
      return a.title.localeCompare(b.title, 'ja'); // ã‚¿ã‚¤ãƒˆãƒ«æ˜‡é †ï¼ˆæ—¥æœ¬èªå¯¾å¿œï¼‰
    }
    return a.status === "æœªè¦–è´" ? -1 : 1;
  });

  sorted.forEach(anime => {
    const ratingStars = anime.rating
  ? "è©•ä¾¡: " + Array(anime.rating)
      .fill("â˜…")
      .map(s => `<span class="star">${s}</span>`)
      .join("")
  : "";

    const siteURL = siteLinks[anime.site] || "#";
    const searchURL = siteSearchLinks[anime.site] + encodeURIComponent(anime.title);

    const li = document.createElement("li");
    if (anime.status === "è¦–è´æ¸ˆã¿") {
      li.classList.add("watched");
    }

    li.innerHTML = `
      <div class="anime-main">
        <div class="anime-details">
          <input
            type="text"
            value="${anime.title}"
            onchange="updateTitle('${anime.title}', this.value)"
            class="title-input"
          />
        </div>
        <div class="anime-meta">
          æ”¾é€æ›œæ—¥: ${anime.weekday}<br>
          ç·è©±æ•°: ${anime.episodes || "ä¸æ˜"}<br>
          <div style="display:flex; align-items:center; gap:6px;">
            ç¾åœ¨è¦–è´è©±æ•°:
            <input type="number" min="0" value="${anime.currentEpisode || ""}"
              onchange="updateCurrentEpisodeDirect('${anime.title}', this.value)"
              style="width:60px; padding:4px; border-radius:4px; border:none; background:#333; color:white;">
          </div>
          <div style="display:flex; align-items:center; gap:6px;">
            <button class="site-btn inline-btn" onclick="toggleSite('${anime.title}')"
              title="è¦–è´ã‚µã‚¤ãƒˆåˆ‡æ›¿">
              <img src="compare_arrows.png" alt="ã‚µã‚¤ãƒˆåˆ‡æ›¿" style="width:13px;height:13px;">
            </button>
            è¦–è´ã‚µã‚¤ãƒˆ:
            <a href="${searchURL}" target="_blank" class="site-link">${anime.site}</a>
          </div>
          çŠ¶æ³: ${anime.status}<br>
          ${ratingStars}
        </div>
      </div>
      <div class="button-group">
        <button class="status-btn" onclick="toggleStatus('${anime.title}')">
          <img src=""https://raw.githubusercontent.com/your-username/anime-todo/main/images/check.png"" alt="è¦–è´åˆ‡æ›¿" style="width:24px;height:24px;">
        </button>
        <button onclick="deleteAnime('${anime.title}')">
          <img src="delete.png" alt="å‰Šé™¤" style="width:24px;height:24px;">
        </button>
      </div>
    `;
    list.appendChild(li);
  });
}

    function saveAnimes() {
      localStorage.setItem("animes", JSON.stringify(animes));
    }

    const showBtn = document.getElementById("showInputButton");
    showBtn.addEventListener("click", () => {
      document.getElementById("inputArea").style.display = "block";
      showBtn.style.display = "none";
    });

    function flashButtonColor(button, color) {
      const originalColor = button.style.backgroundColor;
      button.style.backgroundColor = color;
      setTimeout(() => {
        button.style.backgroundColor = originalColor;
      }, 200);
    }

    const toggle = document.getElementById('modeToggle');
    toggle.addEventListener('click', () => {
      document.body.classList.toggle('light-mode');
    });

  </script>
</body>
</html>
